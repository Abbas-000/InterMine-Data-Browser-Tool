function getColorsArray(e){return["#fbb735","#e98931","#eb403b","#b32E37","#6c2a6a","#5c4399","#274389","#1f5ea8","#227FB0","#2ab0c5","#39c0b3","#b3cae5","#dbdde4","#e4e3e4","#f7ddbb","#efcab2","#bccacc","#c7d8d6","#d9ebe0","#ebf9e3","#f4f8d0","#5e7fb1","#dce8f7","#eff1f4","#fce1a8","#f7ec86","#8fb8ee","#cbe2f4","#dbe5eb","#f9d3b8","#e0b2a3","#a2e0f9","#cef5fc","#eafaeb","#fefcd3","#fdf4ba","#6bafd2","#a4c8dc","#d6cbca","#eabc96","#db8876","#b4ced8","#d7e5d4","#e2e8c9","#f1e5b9","#edd7ac","#29153e","#657489","#bfb6aa","#ead79d","#f2ebda","#20202f","#273550","#416081","#adacb2","#eac3a2","#555351","#555351","#8d7b6c","#cc9d7a","#fff9aa","#171c33","#525f83","#848896","#bb9d78","#f6e183","#ffe3c8","#efad9e","#c79797","#a78a92","#857d8d","#6f749e","#9a8daf","#d0a8b9","#f8bbb1","#fde6b1","#536a97","#8087ad","#bca391","#bd968a","#a38b8a","#325176","#7b9ea7","#9baf93","#dbaf81","#fbdf73","#727288","#8e889b","#d3c2bd","#f9d89a","#f8c785","#506e90","#7695aa","#a7bdb8","#e2e2b8","#fdf998","#634b5f","#868080","#b7b29b","#dfd6a4","#e9f3a2","#7e74b2","#b3a2c2","#e2cdbe","#f6cf97","#f4a77a","#34a4ca","#59d7dd","#a8f2f0","#d0f8ef","#d6f6e1","#7696cd","#8fb2e4","#b0cff0","#d7e5ec","#dee0e7","#8dd6c3","#c5e5e2","#eafaeb","#f9f7ca","#fceea1","#4e72c7","#6d9ed7","#a4c8d5","#b4d9e1","#c4d9d6","#47565f","#5b625a","#947461","#f98056","#f7ec86","#95b3bf","#c6cdd3","#e5d8d9","#f1e1d9","#f3e1cd","#4c86ab","#95a5bc","#bfcdc9","#dcd6c9","#edd9c7","#0f124a","#1b2360","#515b80","#758391","#e5e3b0","#889db6","#a5b8ce","#c1cfdd","#dee1e4","#d5d1cf","#74bddb","#a8d1eb","#cddbf5","#e4e6fb","#f6f4f8","#a7d3cb","#bcc1c4","#e5cab3","#fee6c5","#fdecd0","#325571","#8e9fa4","#decab2","#f2d580","#ffa642","#c5d4d7","#d6b98d","#c99262","#8c5962","#43577e"]}function getOntologyTermsInClass(){return $.ajax({url:"/fetch/ontologyterms/humanmine/"+window.currentClassView,type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getAllelesClinicalSignifanceInClass(){return $.ajax({url:"/fetch/clinicalsignificance/humanmine/"+window.currentClassView,type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getProteinAtlasExpressionCellTypesInClass(){return $.ajax({url:"/fetch/proteinatlascelltypes/humanmine/"+window.currentClassView,type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getProteinAtlasExpressionTissueNamesInClass(){return $.ajax({url:"/fetch/proteinatlastissuenames/humanmine/"+window.currentClassView,type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getAllelesTypesInClass(){return $.ajax({url:"/fetch/allelestype/humanmine/"+window.currentClassView,type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getDatasetNamesInClass(){return $.ajax({url:"/fetch/datasets/humanmine/"+window.currentClassView,type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getPathwayNamesInClass(){return $.ajax({url:"/fetch/pathways/humanmine/"+window.currentClassView,type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getDiseasesNamesInClass(){return $.ajax({url:"/fetch/diseases/humanmine/"+window.currentClassView,type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getProteinDomainNamesInClass(){return $.ajax({url:"/fetch/proteindomainname/humanmine",type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getParticipant2SymbolsInClass(){return $.ajax({url:"/fetch/participant2genesymbols/humanmine",type:"GET",error:function(e){console.log(e)},success:function(e){}})}function getItemsInClass(e){return $.ajax({url:"/statistics/count/items/humanmine/"+window.currentClassView,type:"POST",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",error:function(e){console.log(e)},success:function(e){}})}function flatten(e){return e.reduce(function(e,t){return e.concat(Array.isArray(t)?flatten(t):t)},[])}var myPieChart;function updateTableWithConstraints(){for(;0<window.imTable.query.constraints.length;)window.imTable.query.removeConstraint(window.imTable.query.constraints[0]);0<window.imTableConstraint[0].length&&("Gene"==window.currentClassView?window.imTable.query.addConstraint({path:"goAnnotation.ontologyTerm.name",op:"ONE OF",values:window.imTableConstraint[0]}):window.imTable.query.addConstraint({path:"ontologyAnnotations.ontologyTerm.name",op:"ONE OF",values:window.imTableConstraint[0]})),0<window.imTableConstraint[1].length&&window.imTable.query.addConstraint({path:"dataSets.name",op:"ONE OF",values:window.imTableConstraint[1]}),0<window.imTableConstraint[2].length&&window.imTable.query.addConstraint({path:"pathways.name",op:"ONE OF",values:window.imTableConstraint[2]}),0<window.imTableConstraint[3].length&&("Gene"==window.currentClassView?window.imTable.query.addConstraint({path:"proteins.proteinDomainRegions.proteinDomain.name",op:"ONE OF",values:window.imTableConstraint[3]}):window.imTable.query.addConstraint({path:"proteinDomainRegions.proteinDomain.name",op:"ONE OF",values:window.imTableConstraint[3]})),0<window.imTableConstraint[4].length&&window.imTable.query.addConstraint({path:"diseases.name",op:"ONE OF",values:window.imTableConstraint[4]})}function remove(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}function showMoreDatasetNames(){$.when(getDatasetNamesInClass()).done(function(e){for(var t=[],n=0;n<e.results.length;n++)if(null!=e.results[n].item){if("KEGG pathways data set"==e.results[n].item||"HGNC identifiers"==e.results[n].item||"BioGRID interaction data set"==e.results[n].item||"IntAct interactions data set"==e.results[n].item||"ClinVar data set"==e.results[n].item||"OMIM diseases"==e.results[n].item)continue;t.push({label:e.results[n].item+" ("+e.results[n].count+")",value:e.results[n].item})}var a=[];for(n=0;n<t.length;n++)a.push(t[n].value);a.sort(),a=a.slice(5),console.log(a);var s=a.length;for(n=0;n<s;n++){var i=a[n];$("#datasetsSelector").append('<div class="form-check" style="margin-left: 10px;"><input class="form-check-input" type="checkbox" id="'+i.replace(/[^a-zA-Z0-9]/g,"")+'" value="'+i+'"><label class="form-check-label" for="'+i+'"><p>'+i+"</p></label></div>"),$("#"+i.replace(/[^a-zA-Z0-9]/g,"")).change(function(){if($(this).is(":checked")){var e=$(this).val();window.imTableConstraint[1].push(e),updateTableWithConstraints()}else{e=$(this).val();remove(window.imTableConstraint[1],e),updateTableWithConstraints()}})}})}function updateElements(e,u){$.when(getOntologyTermsInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#goAnnotationSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},updater:function(e){return e},select:function(e,t){e.preventDefault(),$("#goAnnotationSearchInput").val(t.item.value),window.imTableConstraint[0].push(t.item.value),updateTableWithConstraints();var n=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#goAnnotationFilterList").append('<li class="list-group-item" style="height: 50px; padding: 10px 15px;" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><span class="float-md-left">'+t.item.value.slice(0,22)+'</span><div class="input-group-append float-md-right"><button class="btn btn-sm btn-outline-secondary" type="button" id="'+n+'">x</button></li>'),$("#"+n).click(function(){remove(window.imTableConstraint[0],t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#goAnnotationSearchInput").val(t.item.value)}})}),$.when(getDatasetNamesInClass()).done(function(e){if(!window.datasetNamesLoaded){for(var t=[],n=0;n<e.results.length;n++)if(null!=e.results[n].item){if("KEGG pathways data set"==e.results[n].item||"HGNC identifiers"==e.results[n].item||"BioGRID interaction data set"==e.results[n].item||"IntAct interactions data set"==e.results[n].item||"ClinVar data set"==e.results[n].item||"OMIM diseases"==e.results[n].item)continue;t.push({label:e.results[n].item+" ("+e.results[n].count+")",value:e.results[n].item})}$("#datasetsSelector").empty();var a=e.results.length,s=[];for(n=0;n<t.length;n++)s.push(t[n].value);s.sort(),3<a&&(a=3);for(n=0;n<a;n++){var i=s[n];$("#datasetsSelector").append('<div class="form-check" style="margin-left: 10px;"><input class="form-check-input" type="checkbox" id="'+i.replace(/[^a-zA-Z0-9]/g,"")+'" value="'+i+'"><label class="form-check-label" for="'+i+'"><p>'+i+"</p></label></div>"),$("#"+i.replace(/[^a-zA-Z0-9]/g,"")).change(function(){if($(this).is(":checked")){var e=$(this).val();window.imTableConstraint[1].push(e),updateTableWithConstraints()}else{e=$(this).val();remove(window.imTableConstraint[1],e),updateTableWithConstraints()}})}window.datasetNamesLoaded=!0}}),$.when(getPathwayNamesInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#pathwayNameSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#pathwayNameSearchInput").val(t.item.value),window.imTableConstraint[2].push(t.item.value),updateTableWithConstraints();var n=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#pathwayFilterList").append('<li class="list-group-item" style="height: 50px; padding: 10px 15px;" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><span class="float-md-left">'+t.item.value.slice(0,22)+'</span><div class="input-group-append float-md-right"><button class="btn btn-sm btn-outline-secondary" type="button" id="'+n+'">x</button></li>'),$("#"+n).click(function(){remove(window.imTableConstraint[2],t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#pathwayNameSearchInput").val(t.item.value)}})}),$.when(getDiseasesNamesInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#diseasesSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#diseasesSearchInput").val(t.item.value),window.imTableConstraint[4].push(t.item.value),updateTableWithConstraints();var n=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#diseasesFilterList").append('<li class="list-group-item" style="height: 50px; padding: 10px 15px;" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><span class="float-md-left">'+t.item.value.slice(0,22)+'</span><div class="input-group-append float-md-right"><button class="btn btn-sm btn-outline-secondary" type="button" id="'+n+'">x</button></li>'),$("#"+n).click(function(){remove(window.imTableConstraint[4],t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#diseasesSearchInput").val(t.item.value)}})}),$.when(getAllelesClinicalSignifanceInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#clinvarClinicalSignificanceSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#clinvarClinicalSignificanceSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#clinvarClinicalSignificanceSearchInput").val(t.item.value)}})}),$.when(getAllelesTypesInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#clinvarTypeSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#clinvarTypeSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#clinvarTypeSearchInput").val(t.item.value)}})}),$.when(getProteinAtlasExpressionCellTypesInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinLocalisationCellTypeSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinLocalisationCellTypeSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#proteinLocalisationCellTypeSearchInput").val(t.item.value)}})}),$.when(getProteinAtlasExpressionTissueNamesInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinLocalisationTissueSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinLocalisationTissueSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#proteinLocalisationTissueSearchInput").val(t.item.value)}})}),$.when(getProteinDomainNamesInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinDomainNameSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinDomainNameSearchInput").val(t.item.value),window.imTableConstraint[3].push(t.item.value),updateTableWithConstraints();var n=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#proteinDomainNameFilterList").append('<li class="list-group-item" style="height: 50px; padding: 10px 15px;" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><span class="float-md-left">'+t.item.value.slice(0,22)+'</span><div class="input-group-append float-md-right"><button class="btn btn-sm btn-outline-secondary" type="button" id="'+n+'">x</button></li>'),$("#"+n).click(function(){remove(window.imTableConstraint[3],t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#proteinDomainNameSearchInput").val(t.item.value)}})}),$.when(getParticipant2SymbolsInClass()).done(function(e){for(var n=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&n.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#interactionsParticipant2SearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(n,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#interactionsParticipant2SearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#interactionsParticipant2SearchInput").val(t.item.value)}})}),$.when(getItemsInClass(e)).done(function(e){$("#organismshortnamelist").parent().find("li").remove();for(var t=[],n=[],a=getColorsArray(e[0].response.results.length),s=0;s<e[0].response.results.length;s++)t.push(e[0].response.results[s].count),n.push(e[0].response.results[s].item);var i=e[0].response.results.length;5<i&&(i=5);for(s=0;s<i;s++){var l=e[0].response.results[s].item,o="("+e[0].response.results[s].count+")";$("#organismshortnamelist").append('<li class="list-group-item" style="border-width: 2px; border-style: solid; border-color: '+a[s]+';"><a class="nav-link" href="#" style="color:black; text-align:center;"><p class="float-md-left">'+l+'</p><p class="float-md-right">'+o+"</p></a></li>")}createSidebarEvents(),myPieChart&&myPieChart.destroy();var r=document.getElementById(u);for(t=[],n=[],a=getColorsArray(e[0].response.results.length),s=0;s<e[0].response.results.length;s++)t.push(e[0].response.results[s].count),n.push(e[0].response.results[s].item+" ("+e[0].response.results[s].count+")");myPieChart=new Chart(r,{type:"pie",data:{labels:n,datasets:[{data:t,backgroundColor:a}]},options:{responsive:!0,maintainAspectRatio:!1,elements:{center:{text:"90%",color:"#FF6384",fontStyle:"Arial",sidePadding:20}},legend:{display:!0,position:"top",onClick:function(e){e.stopPropagation()}},hover:{mode:"nearest",intersect:!0},tooltips:{callbacks:{label:function(e,t){return t.labels[e.index]}},custom:function(e){e.opacity||(document.getElementById(u).style.cursor="default")}},onClick:function(e,t){if(t.length){var n=t[0]._index;selectedSegment=myPieChart.data.labels[n].split("(")[0].trim(),window.imTable.query.addConstraint({path:"organism.shortName",op:"==",value:selectedSegment})}myPieChart.update()}}})})}$(document).ready(function(){window.location.protocol.includes("https")&&($("#navbarResponsive").prepend("<div class='alert' id='httpsAlert'><span class='closebtn' id='closeHttpsMessage'>×</span>You are currently viewing the HTTPS website. Due to security limitations, we are unable to show results from HTTP-only InterMines. You may be able to see more results if you <a href='http://im-browser-prototype.herokuapp.com/'>reload this site</a> via HTTP.</div><br/>"),$("#closeHttpsMessage").click(function(){$("#httpsAlert").hide()})),$(window).width()<992&&($("#pathwayNameSearchCardBlock").removeClass("show"),$("#datasetNameSearchCardBlock").removeClass("show"),$("#goAnnotationSearchCardBlock").removeClass("show"),$("#locationSearchCardBlock").removeClass("show"),$("#proteinDomainNameSearchCardBlock").removeClass("show")),window.imTableConstraint=[[],[],[],[],[]],window.locationFilter=null,window.interactionsFilter=null,window.clinVarFilter=null,window.expressionFilter=null,window.proteinLocalisationFilter=null});